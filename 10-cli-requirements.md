# Требования к консольным командам

Приложение обязательно должно обязательно выполнять следующую цепочку
команд:

* `validate`
* `clean`
* `install`
* `build`

В отличие от проектов, построенных с помощью сборщиков, для выполнения
этих команд требуется предварительно выполнить
`composer install --no-dev`. Команды последовательно зависят друг от
друга, т.е. команда `validate` выполнится в одиночку, а `install`
предварительно вызовет `validate` и `clean`, при этом подключение к базе
данных проверяться не будет.

## validate

Проверяет приложение на наличие ошибок: присутствие необходимых
ресурсов, наличие ключей конфигурации, подключение к БД.

## clean

Очищает директорию приложения от сгенерированных файлов, будь то
сгенерированный код, временные или `.lock`-файлы.

## install

Устанавливает приложение, скачивая и копирую необходимые ресурсы,
применяя миграции и генерируя необходимый код.

## build

Упаковывает установленное приложение в zip-архив, удаляя машинозависимую
конфигурацию (подключение к БД, данные для подключения к API).

# Написание произвольных команд

Любая команда сначала реализовывается в виде *задачи*, интерфейс которой
может быть произвольным, но единым для всего проекта. Такая задача не
привязана сама по себе ни к консольной команде, ни к консольному выводу:
о существовании консольных команд она не догадывается (консольная
команда сама решает, какие задачи она будет вызывать), весь вывод
осуществляется с помощью произвольного контроллера I/O. Такой подход
позволяет выделить функционал одной конкретной задачи, делать вложенные
задачи, гибко управлять выводом (фильтровать, изменять индентацию и пр.)
и полностью отвязать реализацию от самих команд, что позволяет
дублировать один и тот же функционал без значимых затрат.
